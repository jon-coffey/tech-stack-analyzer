# scan-config.yml - Tech Stack Analyzer Scan Configuration
# Use with: stack-analyzer scan --config scan-config.yml
#
# CONFIGURATION PRECEDENCE (highest to lowest):
# 1. CLI arguments (flags) - Always take precedence
# 2. This scan-config.yml - Overrides project config and defaults
# 3. .stack-analyzer.yml - Project-specific config (merged with scan config)
# 4. Environment variables - Provide defaults for unset values
# 5. Built-in defaults - Used when nothing else is specified

scan:
  # Output configuration
  output:
    file: "results.json"           # Output file path, or "-" for stdout
    pretty: true                   # Pretty print JSON output
    aggregate: "techs,languages"   # Aggregate fields: tech,techs,reason,languages,licenses,dependencies,git,all
  
  # Custom properties added to metadata.properties in scan output
  # Use this to document project context, ownership, or deployment information
  properties:
    product: "My Product Name"
    team: "Platform Engineering"
    owner: "engineering@company.com"
    environment: "production"
    version: "1.2.3"
    # Add any custom key-value pairs relevant to your project
  
  # Files and directories to exclude from scanning
  # Supports glob patterns (**, *, ?)
  exclude:
    # Directories
    - "node_modules"
    - "vendor"
    - "dist"
    - "build"
    - ".git"
    
    # File patterns
    - "*.log"
    - "*.tmp"
    
    # Glob patterns (relative to project root)
    - "**/__tests__/**"
    - "**/*.test.js"
    - "**/test/**"
  
  # Technologies to add to the scan results (even if not auto-detected)
  # Useful for documenting external dependencies, deployment targets, or SaaS services
  techs:
    - tech: "aws"
      reason: "Deployed on AWS ECS"
    - tech: "datadog"
      reason: "Monitoring via Datadog"
    - tech: "auth0"
      reason: "Authentication provider"
    - tech: "stripe"
      reason: "Payment processing"
  
  # Scanner options (behavior flags)
  options:
    verbose: false                  # Show progress with simple output
    debug: true                     # Show progress with tree structure
    no_code_stats: false           # Disable code statistics (lines of code, comments, blanks, complexity)
    component_code_stats: true     # Enable per-component code statistics
    trace_timings: false            # Show timing information for each directory
    trace_rules: false              # Show detailed rule matching information
    filter_rules:                   # Only use these rules (for debugging)
      - "nodejs"
      - "python"
      - "docker"

# Example usage scenarios:
#
# 1. Developer workflow:
#    stack-analyzer scan --config scan-config.yml /path/to/project
#
# 2. CI/CD pipeline with inline JSON:
#    stack-analyzer scan --config '{"scan":{"output":{"file":"$BUILD_DIR/scan-results.json"},"properties":{"build":"'$BUILD_NUMBER'"}}}' /path/to/project
#
# 3. Config overrides (CLI flags take precedence):
#    stack-analyzer scan --config scan-config.yml --verbose --output custom.json /path/to/project
#
# 4. Multiple repositories (simple approach):
#    for repo in repo1 repo2 repo3; do
#      stack-analyzer scan --config scan-config.yml $repo --output $repo-analysis.json
#    done
#
# PRECEDENCE EXAMPLES:
# - CLI flag --debug=true overrides scan-config debug: false
# - scan-config output.file overrides .stack-analyzer.yml output  
# - .stack-analyzer.yml properties merge with scan-config properties
# - Environment variable STACK_ANALYZER_DEBUG provides default when no config sets debug
